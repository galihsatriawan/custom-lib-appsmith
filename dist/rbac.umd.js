!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("buffer"),require("stream"),require("util"),require("crypto")):"function"==typeof define&&define.amd?define(["buffer","stream","util","crypto"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).rbac=t(e.require$$0,e.require$$3,e.require$$5,e.require$$2)}(this,(function(e,t,r,n){"use strict";function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s,o,a,u,c,f,l,h,p,d,m,E,g,y,v,w,b,S,R,$,T,I,A,O,j,N,P,L,k,C,x=i(e),D=i(t),M=i(r),F=i(n),G={},B={exports:{}};function _(){return s||(s=1,function(e,t){var r=x.default,n=r.Buffer;function i(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(i(r,t),t.Buffer=s),s.prototype=Object.create(n.prototype),i(n,s),s.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}}(B,B.exports)),B.exports}function U(){if(a)return o;a=1;var e=_().Buffer,t=D.default;function r(t){if(this.buffer=null,this.writable=!0,this.readable=!0,!t)return this.buffer=e.alloc(0),this;if("function"==typeof t.pipe)return this.buffer=e.alloc(0),t.pipe(this),this;if(t.length||"object"==typeof t)return this.buffer=t,this.writable=!1,process.nextTick(function(){this.emit("end",t),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof t+")")}return M.default.inherits(r,t),r.prototype.write=function(t){this.buffer=e.concat([this.buffer,e.from(t)]),this.emit("data",t)},r.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1},o=r}function V(){if(p)return h;p=1;var e=_().Buffer,t=function(){if(l)return f;function e(e){return(e/8|0)+(e%8==0?0:1)}l=1;var t={ES256:e(256),ES384:e(384),ES512:e(521)};return f=function(e){var r=t[e];if(r)return r;throw new Error('Unknown algorithm "'+e+'"')}}(),r=128;function n(t){if(e.isBuffer(t))return t;if("string"==typeof t)return e.from(t,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function i(e,t,n){for(var i=0;t+i<n&&0===e[t+i];)++i;return e[t+i]>=r&&--i,i}return h={derToJose:function(r,i){r=n(r);var s=t(i),o=s+1,a=r.length,u=0;if(48!==r[u++])throw new Error('Could not find expected "seq"');var c=r[u++];if(129===c&&(c=r[u++]),a-u<c)throw new Error('"seq" specified length of "'+c+'", only "'+(a-u)+'" remaining');if(2!==r[u++])throw new Error('Could not find expected "int" for "r"');var f=r[u++];if(a-u-2<f)throw new Error('"r" specified length of "'+f+'", only "'+(a-u-2)+'" available');if(o<f)throw new Error('"r" specified length of "'+f+'", max of "'+o+'" is acceptable');var l=u;if(u+=f,2!==r[u++])throw new Error('Could not find expected "int" for "s"');var h=r[u++];if(a-u!==h)throw new Error('"s" specified length of "'+h+'", expected "'+(a-u)+'"');if(o<h)throw new Error('"s" specified length of "'+h+'", max of "'+o+'" is acceptable');var p=u;if((u+=h)!==a)throw new Error('Expected to consume entire buffer, but "'+(a-u)+'" bytes remain');var d=s-f,m=s-h,E=e.allocUnsafe(d+f+m+h);for(u=0;u<d;++u)E[u]=0;r.copy(E,u,l+Math.max(-d,0),l+f);for(var g=u=s;u<g+m;++u)E[u]=0;return r.copy(E,u,p+Math.max(-m,0),p+h),E=(E=E.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(s,o){s=n(s);var a=t(o),u=s.length;if(u!==2*a)throw new TypeError('"'+o+'" signatures must be "'+2*a+'" bytes, saw "'+u+'"');var c=i(s,0,a),f=i(s,a,s.length),l=a-c,h=a-f,p=2+l+1+1+h,d=p<r,m=e.allocUnsafe((d?2:3)+p),E=0;return m[E++]=48,d?m[E++]=p:(m[E++]=129,m[E++]=255&p),m[E++]=2,m[E++]=l,c<0?(m[E++]=0,E+=s.copy(m,E,0,a)):E+=s.copy(m,E,c,a),m[E++]=2,m[E++]=h,f<0?(m[E++]=0,s.copy(m,E,a)):s.copy(m,E,a+f),m}}}function H(){if(m)return d;m=1;var e=function(){if(c)return u;c=1;var e=x.default.Buffer,t=x.default.SlowBuffer;function r(t,r){if(!e.isBuffer(t)||!e.isBuffer(r))return!1;if(t.length!==r.length)return!1;for(var n=0,i=0;i<t.length;i++)n|=t[i]^r[i];return 0===n}u=r,r.install=function(){e.prototype.equal=t.prototype.equal=function(e){return r(this,e)}};var n=e.prototype.equal,i=t.prototype.equal;return r.restore=function(){e.prototype.equal=n,t.prototype.equal=i},u}(),t=_().Buffer,r=F.default,n=V(),i=M.default,s="secret must be a string or buffer",o="key must be a string or a buffer",a="function"==typeof r.createPublicKey;function f(e){if(!t.isBuffer(e)&&"string"!=typeof e){if(!a)throw E(o);if("object"!=typeof e)throw E(o);if("string"!=typeof e.type)throw E(o);if("string"!=typeof e.asymmetricKeyType)throw E(o);if("function"!=typeof e.export)throw E(o)}}function l(e){if(!t.isBuffer(e)&&"string"!=typeof e&&"object"!=typeof e)throw E("key must be a string, a buffer or an object")}function h(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function p(e){var t=4-(e=e.toString()).length%4;if(4!==t)for(var r=0;r<t;++r)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}function E(e){var t=[].slice.call(arguments,1),r=i.format.bind(i,e).apply(null,t);return new TypeError(r)}function g(e){var r;return r=e,t.isBuffer(r)||"string"==typeof r||(e=JSON.stringify(e)),e}function y(e){return function(n,i){!function(e){if(!t.isBuffer(e)){if("string"==typeof e)return e;if(!a)throw E(s);if("object"!=typeof e)throw E(s);if("secret"!==e.type)throw E(s);if("function"!=typeof e.export)throw E(s)}}(i),n=g(n);var o=r.createHmac("sha"+e,i);return h((o.update(n),o.digest("base64")))}}function v(r){return function(n,i,s){var o=y(r)(n,s);return e(t.from(i),t.from(o))}}function w(e){return function(t,n){l(n),t=g(t);var i=r.createSign("RSA-SHA"+e);return h((i.update(t),i.sign(n,"base64")))}}function b(e){return function(t,n,i){f(i),t=g(t),n=p(n);var s=r.createVerify("RSA-SHA"+e);return s.update(t),s.verify(i,n,"base64")}}function S(e){return function(t,n){l(n),t=g(t);var i=r.createSign("RSA-SHA"+e);return h((i.update(t),i.sign({key:n,padding:r.constants.RSA_PKCS1_PSS_PADDING,saltLength:r.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function R(e){return function(t,n,i){f(i),t=g(t),n=p(n);var s=r.createVerify("RSA-SHA"+e);return s.update(t),s.verify({key:i,padding:r.constants.RSA_PKCS1_PSS_PADDING,saltLength:r.constants.RSA_PSS_SALTLEN_DIGEST},n,"base64")}}function $(e){var t=w(e);return function(){var r=t.apply(null,arguments);return r=n.derToJose(r,"ES"+e)}}function T(e){var t=b(e);return function(r,i,s){return i=n.joseToDer(i,"ES"+e).toString("base64"),t(r,i,s)}}function I(){return function(){return""}}function A(){return function(e,t){return""===t}}return a&&(o+=" or a KeyObject",s+="or a KeyObject"),d=function(e){var t={hs:y,rs:w,ps:S,es:$,none:I},r={hs:v,rs:b,ps:R,es:T,none:A},n=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!n)throw E('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',e);var i=(n[1]||n[3]).toLowerCase(),s=n[2];return{sign:t[i](s),verify:r[i](s)}}}function z(){if(g)return E;g=1;var e=x.default.Buffer;return E=function(t){return"string"==typeof t?t:"number"==typeof t||e.isBuffer(t)?t.toString():JSON.stringify(t)}}function K(){if(v)return y;v=1;var e=_().Buffer,t=U(),r=H(),n=D.default,i=z(),s=M.default;function o(t,r){return e.from(t,r).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function a(e){var t=e.header,n=e.payload,a=e.secret||e.privateKey,u=e.encoding,c=r(t.alg),f=function(e,t,r){r=r||"utf8";var n=o(i(e),"binary"),a=o(i(t),r);return s.format("%s.%s",n,a)}(t,n,u),l=c.sign(f,a);return s.format("%s.%s",f,l)}function u(e){var r=e.secret||e.privateKey||e.key,n=new t(r);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=n,this.payload=new t(e.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}return s.inherits(u,n),u.prototype.sign=function(){try{var e=a({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},u.sign=a,y=u}function q(){if(b)return w;b=1;var e=_().Buffer,t=U(),r=H(),n=D.default,i=z(),s=M.default,o=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function a(e){if(function(e){return"[object Object]"===Object.prototype.toString.call(e)}(e))return e;try{return JSON.parse(e)}catch(e){return}}function u(t){var r=t.split(".",1)[0];return a(e.from(r,"base64").toString("binary"))}function c(e){return e.split(".")[2]}function f(e){return o.test(e)&&!!u(e)}function l(e,t,n){if(!t){var s=new Error("Missing algorithm parameter for jws.verify");throw s.code="MISSING_ALGORITHM",s}var o=c(e=i(e)),a=function(e){return e.split(".",2).join(".")}(e);return r(t).verify(a,o,n)}function h(t,r){if(r=r||{},!f(t=i(t)))return null;var n=u(t);if(!n)return null;var s=function(t,r){r=r||"utf8";var n=t.split(".")[1];return e.from(n,"base64").toString(r)}(t);return("JWT"===n.typ||r.json)&&(s=JSON.parse(s,r.encoding)),{header:n,payload:s,signature:c(t)}}function p(e){var r=(e=e||{}).secret||e.publicKey||e.key,n=new t(r);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=n,this.signature=new t(e.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}return s.inherits(p,n),p.prototype.verify=function(){try{var e=l(this.signature.buffer,this.algorithm,this.key.buffer),t=h(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},p.decode=h,p.isValid=f,p.verify=l,w=p}function X(){if(S)return G;S=1;var e=K(),t=q();return G.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],G.sign=e.sign,G.verify=t.verify,G.decode=t.decode,G.isValid=t.isValid,G.createSign=function(t){return new e(t)},G.createVerify=function(e){return new t(e)},G}function W(){if($)return R;$=1;var e=X();return R=function(t,r){r=r||{};var n=e.decode(t,r);if(!n)return null;var i=n.payload;if("string"==typeof i)try{var s=JSON.parse(i);null!==s&&"object"==typeof s&&(i=s)}catch(e){}return!0===r.complete?{header:n.header,payload:i,signature:n.signature}:i}}function J(){if(I)return T;I=1;var e=function(e,t){Error.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=e,t&&(this.inner=t)};return(e.prototype=Object.create(Error.prototype)).constructor=e,T=e}function Y(){if(O)return A;O=1;var e=J(),t=function(t,r){e.call(this,t),this.name="NotBeforeError",this.date=r};return(t.prototype=Object.create(e.prototype)).constructor=t,A=t}function Z(){if(N)return j;N=1;var e=J(),t=function(t,r){e.call(this,t),this.name="TokenExpiredError",this.expiredAt=r};return(t.prototype=Object.create(e.prototype)).constructor=t,j=t}function Q(){if(L)return P;L=1;var e=1e3,t=60*e,r=60*t,n=24*r,i=7*n,s=365.25*n;function o(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}return P=function(a,u){u=u||{};var c=typeof a;if("string"===c&&a.length>0)return function(o){if((o=String(o)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(o);if(!a)return;var u=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return u*s;case"weeks":case"week":case"w":return u*i;case"days":case"day":case"d":return u*n;case"hours":case"hour":case"hrs":case"hr":case"h":return u*r;case"minutes":case"minute":case"mins":case"min":case"m":return u*t;case"seconds":case"second":case"secs":case"sec":case"s":return u*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return u;default:return}}(a);if("number"===c&&isFinite(a))return u.long?function(i){var s=Math.abs(i);if(s>=n)return o(i,s,n,"day");if(s>=r)return o(i,s,r,"hour");if(s>=t)return o(i,s,t,"minute");if(s>=e)return o(i,s,e,"second");return i+" ms"}(a):function(i){var s=Math.abs(i);if(s>=n)return Math.round(i/n)+"d";if(s>=r)return Math.round(i/r)+"h";if(s>=t)return Math.round(i/t)+"m";if(s>=e)return Math.round(i/e)+"s";return i+"ms"}(a);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))}}function ee(){if(C)return k;C=1;var e=Q();return k=function(t,r){var n=r||Math.floor(Date.now()/1e3);if("string"==typeof t){var i=e(t);if(void 0===i)return;return Math.floor(n+i/1e3)}return"number"==typeof t?n+t:void 0}}var te,re,ne,ie,se,oe,ae,ue,ce,fe,le,he,pe,de,me,Ee,ge,ye,ve,we,be,Se,Re,$e,Te,Ie,Ae,Oe,je,Ne,Pe,Le,ke,Ce,xe,De,Me,Fe,Ge,Be,_e,Ue,Ve,He,ze,Ke,qe,Xe,We,Je,Ye,Ze,Qe,et,tt,rt,nt,it,st,ot,at,ut,ct,ft,lt,ht,pt,dt,mt,Et,gt,yt,vt,wt,bt,St,Rt,$t,Tt,It,At,Ot,jt,Nt,Pt,Lt,kt,Ct,xt,Dt,Mt,Ft,Gt,Bt,_t,Ut,Vt,Ht,zt,Kt,qt,Xt,Wt,Jt,Yt,Zt,Qt,er,tr,rr,nr,ir,sr,or,ar,ur,cr,fr={exports:{}};function lr(){if(re)return te;re=1;const e=Number.MAX_SAFE_INTEGER||9007199254740991;return te={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:e,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}}function hr(){if(ie)return ne;ie=1;const e="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};return ne=e}function pr(){return se||(se=1,function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:i}=lr(),s=hr(),o=(t=e.exports={}).re=[],a=t.safeRe=[],u=t.src=[],c=t.t={};let f=0;const l="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",i],[l,n]],p=(e,t,r)=>{const n=(e=>{for(const[t,r]of h)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e})(t),i=f++;s(e,i,t),c[e]=i,u[i]=t,o[i]=new RegExp(t,r?"g":void 0),a[i]=new RegExp(n,r?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${l}*`),p("MAINVERSION",`(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${u[c.NUMERICIDENTIFIER]}|${u[c.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${u[c.NUMERICIDENTIFIERLOOSE]}|${u[c.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${u[c.PRERELEASEIDENTIFIER]}(?:\\.${u[c.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${u[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[c.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${l}+`),p("BUILD",`(?:\\+(${u[c.BUILDIDENTIFIER]}(?:\\.${u[c.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${u[c.MAINVERSION]}${u[c.PRERELEASE]}?${u[c.BUILD]}?`),p("FULL",`^${u[c.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${u[c.MAINVERSIONLOOSE]}${u[c.PRERELEASELOOSE]}?${u[c.BUILD]}?`),p("LOOSE",`^${u[c.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${u[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${u[c.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:${u[c.PRERELEASE]})?${u[c.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:${u[c.PRERELEASELOOSE]})?${u[c.BUILD]}?)?)?`),p("XRANGE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAINLOOSE]}$`),p("COERCEPLAIN",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?`),p("COERCE",`${u[c.COERCEPLAIN]}(?:$|[^\\d])`),p("COERCEFULL",u[c.COERCEPLAIN]+`(?:${u[c.PRERELEASE]})?`+`(?:${u[c.BUILD]})?(?:$|[^\\d])`),p("COERCERTL",u[c.COERCE],!0),p("COERCERTLFULL",u[c.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${u[c.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",p("TILDE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${u[c.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",p("CARET",`^${u[c.LONECARET]}${u[c.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${u[c.LONECARET]}${u[c.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${u[c.GTLT]}\\s*(${u[c.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]}|${u[c.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${u[c.XRANGEPLAIN]})\\s+-\\s+(${u[c.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${u[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[c.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(fr,fr.exports)),fr.exports}function dr(){if(ae)return oe;ae=1;const e=Object.freeze({loose:!0}),t=Object.freeze({});return oe=r=>r?"object"!=typeof r?e:r:t}function mr(){if(ce)return ue;ce=1;const e=/^[0-9]+$/,t=(t,r)=>{const n=e.test(t),i=e.test(r);return n&&i&&(t=+t,r=+r),t===r?0:n&&!i?-1:i&&!n?1:t<r?-1:1};return ue={compareIdentifiers:t,rcompareIdentifiers:(e,r)=>t(r,e)}}function Er(){if(le)return fe;le=1;const e=hr(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:r}=lr(),{safeRe:n,t:i}=pr(),s=dr(),{compareIdentifiers:o}=mr();class a{constructor(o,u){if(u=s(u),o instanceof a){if(o.loose===!!u.loose&&o.includePrerelease===!!u.includePrerelease)return o;o=o.version}else if("string"!=typeof o)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof o}".`);if(o.length>t)throw new TypeError(`version is longer than ${t} characters`);e("SemVer",o,u),this.options=u,this.loose=!!u.loose,this.includePrerelease=!!u.includePrerelease;const c=o.trim().match(u.loose?n[i.LOOSE]:n[i.FULL]);if(!c)throw new TypeError(`Invalid Version: ${o}`);if(this.raw=o,this.major=+c[1],this.minor=+c[2],this.patch=+c[3],this.major>r||this.major<0)throw new TypeError("Invalid major version");if(this.minor>r||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>r||this.patch<0)throw new TypeError("Invalid patch version");c[4]?this.prerelease=c[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<r)return t}return e})):this.prerelease=[],this.build=c[5]?c[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(e("SemVer.compare",this.version,this.options,t),!(t instanceof a)){if("string"==typeof t&&t===this.version)return 0;t=new a(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(e){return e instanceof a||(e=new a(e,this.options)),o(this.major,e.major)||o(this.minor,e.minor)||o(this.patch,e.patch)}comparePre(t){if(t instanceof a||(t=new a(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let r=0;do{const n=this.prerelease[r],i=t.prerelease[r];if(e("prerelease compare",r,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return o(n,i)}while(++r)}compareBuild(t){t instanceof a||(t=new a(t,this.options));let r=0;do{const n=this.build[r],i=t.build[r];if(e("build compare",r,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return o(n,i)}while(++r)}inc(e,t,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(r)?1:0;if(!t&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let n=this.prerelease.length;for(;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);if(-1===n){if(t===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let n=[t,e];!1===r&&(n=[t]),0===o(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=n):this.prerelease=n}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return fe=a}function gr(){if(pe)return he;pe=1;const e=Er();return he=(t,r,n=!1)=>{if(t instanceof e)return t;try{return new e(t,r)}catch(e){if(!n)return null;throw e}}}function yr(){if(Pe)return Ne;Pe=1;const e=Er();return Ne=(t,r,n)=>new e(t,n).compare(new e(r,n))}function vr(){if(Me)return De;Me=1;const e=Er();return De=(t,r,n)=>{const i=new e(t,n),s=new e(r,n);return i.compare(s)||i.compareBuild(s)}}function wr(){if(Ve)return Ue;Ve=1;const e=yr();return Ue=(t,r,n)=>e(t,r,n)>0}function br(){if(ze)return He;ze=1;const e=yr();return He=(t,r,n)=>e(t,r,n)<0}function Sr(){if(qe)return Ke;qe=1;const e=yr();return Ke=(t,r,n)=>0===e(t,r,n)}function Rr(){if(We)return Xe;We=1;const e=yr();return Xe=(t,r,n)=>0!==e(t,r,n)}function $r(){if(Ye)return Je;Ye=1;const e=yr();return Je=(t,r,n)=>e(t,r,n)>=0}function Tr(){if(Qe)return Ze;Qe=1;const e=yr();return Ze=(t,r,n)=>e(t,r,n)<=0}function Ir(){if(tt)return et;tt=1;const e=Sr(),t=Rr(),r=wr(),n=$r(),i=br(),s=Tr();return et=(o,a,u,c)=>{switch(a){case"===":return"object"==typeof o&&(o=o.version),"object"==typeof u&&(u=u.version),o===u;case"!==":return"object"==typeof o&&(o=o.version),"object"==typeof u&&(u=u.version),o!==u;case"":case"=":case"==":return e(o,u,c);case"!=":return t(o,u,c);case">":return r(o,u,c);case">=":return n(o,u,c);case"<":return i(o,u,c);case"<=":return s(o,u,c);default:throw new TypeError(`Invalid operator: ${a}`)}}}function Ar(){if(at)return ot;at=1;const e=/\s+/g;class t{constructor(r,s){if(s=n(s),r instanceof t)return r.loose===!!s.loose&&r.includePrerelease===!!s.includePrerelease?r:new t(r.raw,s);if(r instanceof i)return this.raw=r.value,this.set=[[r]],this.formatted=void 0,this;if(this.options=s,this.loose=!!s.loose,this.includePrerelease=!!s.includePrerelease,this.raw=r.trim().replace(e," "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!d(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&m(e[0])){this.set=[e];break}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");const t=this.set[e];for(let e=0;e<t.length;e++)e>0&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&h)|(this.options.loose&&p))+":"+e,n=r.get(t);if(n)return n;const o=this.options.loose,m=o?a[u.HYPHENRANGELOOSE]:a[u.HYPHENRANGE];e=e.replace(m,A(this.options.includePrerelease)),s("hyphen replace",e),e=e.replace(a[u.COMPARATORTRIM],c),s("comparator trim",e),e=e.replace(a[u.TILDETRIM],f),s("tilde trim",e),e=e.replace(a[u.CARETTRIM],l),s("caret trim",e);let E=e.split(" ").map((e=>g(e,this.options))).join(" ").split(/\s+/).map((e=>I(e,this.options)));o&&(E=E.filter((e=>(s("loose invalid filter",e,this.options),!!e.match(a[u.COMPARATORLOOSE]))))),s("range list",E);const y=new Map,v=E.map((e=>new i(e,this.options)));for(const e of v){if(d(e))return[e];y.set(e.value,e)}y.size>1&&y.has("")&&y.delete("");const w=[...y.values()];return r.set(t,w),w}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some((t=>E(t,r)&&e.set.some((e=>E(e,r)&&t.every((t=>e.every((e=>t.intersects(e,r)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new o(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(O(this.set[t],e,this.options))return!0;return!1}}ot=t;const r=new(st?it:(st=1,it=class{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}})),n=dr(),i=Or(),s=hr(),o=Er(),{safeRe:a,t:u,comparatorTrimReplace:c,tildeTrimReplace:f,caretTrimReplace:l}=pr(),{FLAG_INCLUDE_PRERELEASE:h,FLAG_LOOSE:p}=lr(),d=e=>"<0.0.0-0"===e.value,m=e=>""===e.value,E=(e,t)=>{let r=!0;const n=e.slice();let i=n.pop();for(;r&&n.length;)r=n.every((e=>i.intersects(e,t))),i=n.pop();return r},g=(e,t)=>(s("comp",e,t),e=b(e,t),s("caret",e),e=v(e,t),s("tildes",e),e=R(e,t),s("xrange",e),e=T(e,t),s("stars",e),e),y=e=>!e||"x"===e.toLowerCase()||"*"===e,v=(e,t)=>e.trim().split(/\s+/).map((e=>w(e,t))).join(" "),w=(e,t)=>{const r=t.loose?a[u.TILDELOOSE]:a[u.TILDE];return e.replace(r,((t,r,n,i,o)=>{let a;return s("tilde",e,t,r,n,i,o),y(r)?a="":y(n)?a=`>=${r}.0.0 <${+r+1}.0.0-0`:y(i)?a=`>=${r}.${n}.0 <${r}.${+n+1}.0-0`:o?(s("replaceTilde pr",o),a=`>=${r}.${n}.${i}-${o} <${r}.${+n+1}.0-0`):a=`>=${r}.${n}.${i} <${r}.${+n+1}.0-0`,s("tilde return",a),a}))},b=(e,t)=>e.trim().split(/\s+/).map((e=>S(e,t))).join(" "),S=(e,t)=>{s("caret",e,t);const r=t.loose?a[u.CARETLOOSE]:a[u.CARET],n=t.includePrerelease?"-0":"";return e.replace(r,((t,r,i,o,a)=>{let u;return s("caret",e,t,r,i,o,a),y(r)?u="":y(i)?u=`>=${r}.0.0${n} <${+r+1}.0.0-0`:y(o)?u="0"===r?`>=${r}.${i}.0${n} <${r}.${+i+1}.0-0`:`>=${r}.${i}.0${n} <${+r+1}.0.0-0`:a?(s("replaceCaret pr",a),u="0"===r?"0"===i?`>=${r}.${i}.${o}-${a} <${r}.${i}.${+o+1}-0`:`>=${r}.${i}.${o}-${a} <${r}.${+i+1}.0-0`:`>=${r}.${i}.${o}-${a} <${+r+1}.0.0-0`):(s("no pr"),u="0"===r?"0"===i?`>=${r}.${i}.${o}${n} <${r}.${i}.${+o+1}-0`:`>=${r}.${i}.${o}${n} <${r}.${+i+1}.0-0`:`>=${r}.${i}.${o} <${+r+1}.0.0-0`),s("caret return",u),u}))},R=(e,t)=>(s("replaceXRanges",e,t),e.split(/\s+/).map((e=>$(e,t))).join(" ")),$=(e,t)=>{e=e.trim();const r=t.loose?a[u.XRANGELOOSE]:a[u.XRANGE];return e.replace(r,((r,n,i,o,a,u)=>{s("xRange",e,r,n,i,o,a,u);const c=y(i),f=c||y(o),l=f||y(a),h=l;return"="===n&&h&&(n=""),u=t.includePrerelease?"-0":"",c?r=">"===n||"<"===n?"<0.0.0-0":"*":n&&h?(f&&(o=0),a=0,">"===n?(n=">=",f?(i=+i+1,o=0,a=0):(o=+o+1,a=0)):"<="===n&&(n="<",f?i=+i+1:o=+o+1),"<"===n&&(u="-0"),r=`${n+i}.${o}.${a}${u}`):f?r=`>=${i}.0.0${u} <${+i+1}.0.0-0`:l&&(r=`>=${i}.${o}.0${u} <${i}.${+o+1}.0-0`),s("xRange return",r),r}))},T=(e,t)=>(s("replaceStars",e,t),e.trim().replace(a[u.STAR],"")),I=(e,t)=>(s("replaceGTE0",e,t),e.trim().replace(a[t.includePrerelease?u.GTE0PRE:u.GTE0],"")),A=e=>(t,r,n,i,s,o,a,u,c,f,l,h)=>`${r=y(n)?"":y(i)?`>=${n}.0.0${e?"-0":""}`:y(s)?`>=${n}.${i}.0${e?"-0":""}`:o?`>=${r}`:`>=${r}${e?"-0":""}`} ${u=y(c)?"":y(f)?`<${+c+1}.0.0-0`:y(l)?`<${c}.${+f+1}.0-0`:h?`<=${c}.${f}.${l}-${h}`:e?`<${c}.${f}.${+l+1}-0`:`<=${u}`}`.trim(),O=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(s(e[r].semver),e[r].semver!==i.ANY&&e[r].semver.prerelease.length>0){const n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0};return ot}function Or(){if(ct)return ut;ct=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(n,i){if(i=r(i),n instanceof t){if(n.loose===!!i.loose)return n;n=n.value}n=n.trim().split(/\s+/).join(" "),o("comparator",n,i),this.options=i,this.loose=!!i.loose,this.parse(n),this.semver===e?this.value="":this.value=this.operator+this.semver.version,o("comp",this)}parse(t){const r=this.options.loose?n[i.COMPARATORLOOSE]:n[i.COMPARATOR],s=t.match(r);if(!s)throw new TypeError(`Invalid comparator: ${t}`);this.operator=void 0!==s[1]?s[1]:"","="===this.operator&&(this.operator=""),s[2]?this.semver=new a(s[2],this.options.loose):this.semver=e}toString(){return this.value}test(t){if(o("Comparator.test",t,this.options.loose),this.semver===e||t===e)return!0;if("string"==typeof t)try{t=new a(t,this.options)}catch(e){return!1}return s(t,this.operator,this.semver,this.options)}intersects(e,n){if(!(e instanceof t))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new u(e.value,n).test(this.value):""===e.operator?""===e.value||new u(this.value,n).test(e.semver):(!(n=r(n)).includePrerelease||"<0.0.0-0"!==this.value&&"<0.0.0-0"!==e.value)&&(!(!n.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0")))&&(!(!this.operator.startsWith(">")||!e.operator.startsWith(">"))||(!(!this.operator.startsWith("<")||!e.operator.startsWith("<"))||(!(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))||(!!(s(this.semver,"<",e.semver,n)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))||!!(s(this.semver,">",e.semver,n)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))))))}}ut=t;const r=dr(),{safeRe:n,t:i}=pr(),s=Ir(),o=hr(),a=Er(),u=Ar();return ut}function jr(){if(lt)return ft;lt=1;const e=Ar();return ft=(t,r,n)=>{try{r=new e(r,n)}catch(e){return!1}return r.test(t)},ft}function Nr(){if(bt)return wt;bt=1;const e=Ar();return wt=(t,r)=>{try{return new e(t,r).range||"*"}catch(e){return null}},wt}function Pr(){if(Rt)return St;Rt=1;const e=Er(),t=Or(),{ANY:r}=t,n=Ar(),i=jr(),s=wr(),o=br(),a=Tr(),u=$r();return St=(c,f,l,h)=>{let p,d,m,E,g;switch(c=new e(c,h),f=new n(f,h),l){case">":p=s,d=a,m=o,E=">",g=">=";break;case"<":p=o,d=u,m=s,E="<",g="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(i(c,f,h))return!1;for(let e=0;e<f.set.length;++e){const n=f.set[e];let i=null,s=null;if(n.forEach((e=>{e.semver===r&&(e=new t(">=0.0.0")),i=i||e,s=s||e,p(e.semver,i.semver,h)?i=e:m(e.semver,s.semver,h)&&(s=e)})),i.operator===E||i.operator===g)return!1;if((!s.operator||s.operator===E)&&d(c,s.semver))return!1;if(s.operator===g&&m(c,s.semver))return!1}return!0},St}function Lr(){if(xt)return Ct;xt=1;const e=pr(),t=lr(),r=Er(),n=mr(),i=gr(),s=function(){if(me)return de;me=1;const e=gr();return de=(t,r)=>{const n=e(t,r);return n?n.version:null}}(),o=function(){if(ge)return Ee;ge=1;const e=gr();return Ee=(t,r)=>{const n=e(t.trim().replace(/^[=v]+/,""),r);return n?n.version:null}}(),a=function(){if(ve)return ye;ve=1;const e=Er();return ye=(t,r,n,i,s)=>{"string"==typeof n&&(s=i,i=n,n=void 0);try{return new e(t instanceof e?t.version:t,n).inc(r,i,s).version}catch(e){return null}}}(),u=function(){if(be)return we;be=1;const e=gr();return we=(t,r)=>{const n=e(t,null,!0),i=e(r,null,!0),s=n.compare(i);if(0===s)return null;const o=s>0,a=o?n:i,u=o?i:n,c=!!a.prerelease.length;if(u.prerelease.length&&!c)return u.patch||u.minor?a.patch?"patch":a.minor?"minor":"major":"major";const f=c?"pre":"";return n.major!==i.major?f+"major":n.minor!==i.minor?f+"minor":n.patch!==i.patch?f+"patch":"prerelease"}}(),c=function(){if(Re)return Se;Re=1;const e=Er();return Se=(t,r)=>new e(t,r).major}(),f=function(){if(Te)return $e;Te=1;const e=Er();return $e=(t,r)=>new e(t,r).minor}(),l=function(){if(Ae)return Ie;Ae=1;const e=Er();return Ie=(t,r)=>new e(t,r).patch}(),h=function(){if(je)return Oe;je=1;const e=gr();return Oe=(t,r)=>{const n=e(t,r);return n&&n.prerelease.length?n.prerelease:null}}(),p=yr(),d=function(){if(ke)return Le;ke=1;const e=yr();return Le=(t,r,n)=>e(r,t,n)}(),m=function(){if(xe)return Ce;xe=1;const e=yr();return Ce=(t,r)=>e(t,r,!0)}(),E=vr(),g=function(){if(Ge)return Fe;Ge=1;const e=vr();return Fe=(t,r)=>t.sort(((t,n)=>e(t,n,r)))}(),y=function(){if(_e)return Be;_e=1;const e=vr();return Be=(t,r)=>t.sort(((t,n)=>e(n,t,r)))}(),v=wr(),w=br(),b=Sr(),S=Rr(),R=$r(),$=Tr(),T=Ir(),I=function(){if(nt)return rt;nt=1;const e=Er(),t=gr(),{safeRe:r,t:n}=pr();return rt=(i,s)=>{if(i instanceof e)return i;if("number"==typeof i&&(i=String(i)),"string"!=typeof i)return null;let o=null;if((s=s||{}).rtl){const e=s.includePrerelease?r[n.COERCERTLFULL]:r[n.COERCERTL];let t;for(;(t=e.exec(i))&&(!o||o.index+o[0].length!==i.length);)o&&t.index+t[0].length===o.index+o[0].length||(o=t),e.lastIndex=t.index+t[1].length+t[2].length;e.lastIndex=-1}else o=i.match(s.includePrerelease?r[n.COERCEFULL]:r[n.COERCE]);if(null===o)return null;const a=o[2],u=o[3]||"0",c=o[4]||"0",f=s.includePrerelease&&o[5]?`-${o[5]}`:"",l=s.includePrerelease&&o[6]?`+${o[6]}`:"";return t(`${a}.${u}.${c}${f}${l}`,s)}}(),A=Or(),O=Ar(),j=jr(),N=function(){if(pt)return ht;pt=1;const e=Ar();return ht=(t,r)=>new e(t,r).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" "))),ht}(),P=function(){if(mt)return dt;mt=1;const e=Er(),t=Ar();return dt=(r,n,i)=>{let s=null,o=null,a=null;try{a=new t(n,i)}catch(e){return null}return r.forEach((t=>{a.test(t)&&(s&&-1!==o.compare(t)||(s=t,o=new e(s,i)))})),s},dt}(),L=function(){if(gt)return Et;gt=1;const e=Er(),t=Ar();return Et=(r,n,i)=>{let s=null,o=null,a=null;try{a=new t(n,i)}catch(e){return null}return r.forEach((t=>{a.test(t)&&(s&&1!==o.compare(t)||(s=t,o=new e(s,i)))})),s},Et}(),k=function(){if(vt)return yt;vt=1;const e=Er(),t=Ar(),r=wr();return yt=(n,i)=>{n=new t(n,i);let s=new e("0.0.0");if(n.test(s))return s;if(s=new e("0.0.0-0"),n.test(s))return s;s=null;for(let t=0;t<n.set.length;++t){const i=n.set[t];let o=null;i.forEach((t=>{const n=new e(t.semver.version);switch(t.operator){case">":0===n.prerelease.length?n.patch++:n.prerelease.push(0),n.raw=n.format();case"":case">=":o&&!r(n,o)||(o=n);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${t.operator}`)}})),!o||s&&!r(s,o)||(s=o)}return s&&n.test(s)?s:null},yt}(),C=Nr(),x=Pr(),D=function(){if(Tt)return $t;Tt=1;const e=Pr();return $t=(t,r,n)=>e(t,r,">",n),$t}(),M=function(){if(At)return It;At=1;const e=Pr();return It=(t,r,n)=>e(t,r,"<",n),It}(),F=function(){if(jt)return Ot;jt=1;const e=Ar();return Ot=(t,r,n)=>(t=new e(t,n),r=new e(r,n),t.intersects(r,n))}(),G=function(){if(Pt)return Nt;Pt=1;const e=jr(),t=yr();return Nt=(r,n,i)=>{const s=[];let o=null,a=null;const u=r.sort(((e,r)=>t(e,r,i)));for(const t of u)e(t,n,i)?(a=t,o||(o=t)):(a&&s.push([o,a]),a=null,o=null);o&&s.push([o,null]);const c=[];for(const[e,t]of s)e===t?c.push(e):t||e!==u[0]?t?e===u[0]?c.push(`<=${t}`):c.push(`${e} - ${t}`):c.push(`>=${e}`):c.push("*");const f=c.join(" || "),l="string"==typeof n.raw?n.raw:String(n);return f.length<l.length?f:n},Nt}(),B=function(){if(kt)return Lt;kt=1;const e=Ar(),t=Or(),{ANY:r}=t,n=jr(),i=yr(),s=[new t(">=0.0.0-0")],o=[new t(">=0.0.0")],a=(e,t,a)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===r){if(1===t.length&&t[0].semver===r)return!0;e=a.includePrerelease?s:o}if(1===t.length&&t[0].semver===r){if(a.includePrerelease)return!0;t=o}const f=new Set;let l,h,p,d,m,E,g;for(const t of e)">"===t.operator||">="===t.operator?l=u(l,t,a):"<"===t.operator||"<="===t.operator?h=c(h,t,a):f.add(t.semver);if(f.size>1)return null;if(l&&h){if(p=i(l.semver,h.semver,a),p>0)return null;if(0===p&&(">="!==l.operator||"<="!==h.operator))return null}for(const e of f){if(l&&!n(e,String(l),a))return null;if(h&&!n(e,String(h),a))return null;for(const r of t)if(!n(e,String(r),a))return!1;return!0}let y=!(!h||a.includePrerelease||!h.semver.prerelease.length)&&h.semver,v=!(!l||a.includePrerelease||!l.semver.prerelease.length)&&l.semver;y&&1===y.prerelease.length&&"<"===h.operator&&0===y.prerelease[0]&&(y=!1);for(const e of t){if(g=g||">"===e.operator||">="===e.operator,E=E||"<"===e.operator||"<="===e.operator,l)if(v&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===v.major&&e.semver.minor===v.minor&&e.semver.patch===v.patch&&(v=!1),">"===e.operator||">="===e.operator){if(d=u(l,e,a),d===e&&d!==l)return!1}else if(">="===l.operator&&!n(l.semver,String(e),a))return!1;if(h)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),"<"===e.operator||"<="===e.operator){if(m=c(h,e,a),m===e&&m!==h)return!1}else if("<="===h.operator&&!n(h.semver,String(e),a))return!1;if(!e.operator&&(h||l)&&0!==p)return!1}return!(l&&E&&!h&&0!==p||h&&g&&!l&&0!==p||v||y)},u=(e,t,r)=>{if(!e)return t;const n=i(e.semver,t.semver,r);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},c=(e,t,r)=>{if(!e)return t;const n=i(e.semver,t.semver,r);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};return Lt=(t,r,n={})=>{if(t===r)return!0;t=new e(t,n),r=new e(r,n);let i=!1;e:for(const e of t.set){for(const t of r.set){const r=a(e,t,n);if(i=i||null!==r,r)continue e}if(i)return!1}return!0}}();return Ct={parse:i,valid:s,clean:o,inc:a,diff:u,major:c,minor:f,patch:l,prerelease:h,compare:p,rcompare:d,compareLoose:m,compareBuild:E,sort:g,rsort:y,gt:v,lt:w,eq:b,neq:S,gte:R,lte:$,cmp:T,coerce:I,Comparator:A,Range:O,satisfies:j,toComparators:N,maxSatisfying:P,minSatisfying:L,minVersion:k,validRange:C,outside:x,gtr:D,ltr:M,intersects:F,simplifyRange:G,subset:B,SemVer:r,re:e.re,src:e.src,tokens:e.t,SEMVER_SPEC_VERSION:t.SEMVER_SPEC_VERSION,RELEASE_TYPES:t.RELEASE_TYPES,compareIdentifiers:n.compareIdentifiers,rcompareIdentifiers:n.rcompareIdentifiers}}function kr(){if(_t)return Bt;_t=1;const e=function(){if(Mt)return Dt;Mt=1;const e=Lr();return Dt=e.satisfies(process.version,">=15.7.0")}(),t=function(){if(Gt)return Ft;Gt=1;const e=Lr();return Ft=e.satisfies(process.version,">=16.9.0")}(),r={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},n={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};return Bt=function(i,s){if(!i||!s)return;const o=s.asymmetricKeyType;if(!o)return;const a=r[o];if(!a)throw new Error(`Unknown key type "${o}".`);if(!a.includes(i))throw new Error(`"alg" parameter for "${o}" key type must be one of: ${a.join(", ")}.`);if(e)switch(o){case"ec":const e=s.asymmetricKeyDetails.namedCurve,r=n[i];if(e!==r)throw new Error(`"alg" parameter "${i}" requires curve "${r}".`);break;case"rsa-pss":if(t){const e=parseInt(i.slice(-3),10),{hashAlgorithm:t,mgf1HashAlgorithm:r,saltLength:n}=s.asymmetricKeyDetails;if(t!==`sha${e}`||r!==t)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${i}.`);if(void 0!==n&&n>e>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${i}.`)}}}}function Cr(){if(Vt)return Ut;Vt=1;var e=Lr();return Ut=e.satisfies(process.version,"^6.12.0 || >=8.0.0")}function xr(){if(zt)return Ht;zt=1;const e=J(),t=Y(),r=Z(),n=W(),i=ee(),s=kr(),o=Cr(),a=X(),{KeyObject:u,createSecretKey:c,createPublicKey:f}=F.default,l=["RS256","RS384","RS512"],h=["ES256","ES384","ES512"],p=["RS256","RS384","RS512"],d=["HS256","HS384","HS512"];return o&&(l.splice(l.length,0,"PS256","PS384","PS512"),p.splice(p.length,0,"PS256","PS384","PS512")),Ht=function(o,m,E,g){let y;if("function"!=typeof E||g||(g=E,E={}),E||(E={}),E=Object.assign({},E),y=g||function(e,t){if(e)throw e;return t},E.clockTimestamp&&"number"!=typeof E.clockTimestamp)return y(new e("clockTimestamp must be a number"));if(void 0!==E.nonce&&("string"!=typeof E.nonce||""===E.nonce.trim()))return y(new e("nonce must be a non-empty string"));if(void 0!==E.allowInvalidAsymmetricKeyTypes&&"boolean"!=typeof E.allowInvalidAsymmetricKeyTypes)return y(new e("allowInvalidAsymmetricKeyTypes must be a boolean"));const v=E.clockTimestamp||Math.floor(Date.now()/1e3);if(!o)return y(new e("jwt must be provided"));if("string"!=typeof o)return y(new e("jwt must be a string"));const w=o.split(".");if(3!==w.length)return y(new e("jwt malformed"));let b;try{b=n(o,{complete:!0})}catch(e){return y(e)}if(!b)return y(new e("invalid token"));const S=b.header;let R;if("function"==typeof m){if(!g)return y(new e("verify must be called asynchronous if secret or public key is provided as a callback"));R=m}else R=function(e,t){return t(null,m)};return R(S,(function(n,m){if(n)return y(new e("error in secret or public key callback: "+n.message));const g=""!==w[2].trim();if(!g&&m)return y(new e("jwt signature is required"));if(g&&!m)return y(new e("secret or public key must be provided"));if(!g&&!E.algorithms)return y(new e('please specify "none" in "algorithms" to verify unsigned tokens'));if(null!=m&&!(m instanceof u))try{m=f(m)}catch(t){try{m=c("string"==typeof m?Buffer.from(m):m)}catch(t){return y(new e("secretOrPublicKey is not valid key material"))}}if(E.algorithms||("secret"===m.type?E.algorithms=d:["rsa","rsa-pss"].includes(m.asymmetricKeyType)?E.algorithms=p:"ec"===m.asymmetricKeyType?E.algorithms=h:E.algorithms=l),-1===E.algorithms.indexOf(b.header.alg))return y(new e("invalid algorithm"));if(S.alg.startsWith("HS")&&"secret"!==m.type)return y(new e(`secretOrPublicKey must be a symmetric key when using ${S.alg}`));if(/^(?:RS|PS|ES)/.test(S.alg)&&"public"!==m.type)return y(new e(`secretOrPublicKey must be an asymmetric key when using ${S.alg}`));if(!E.allowInvalidAsymmetricKeyTypes)try{s(S.alg,m)}catch(e){return y(e)}let R;try{R=a.verify(o,b.header.alg,m)}catch(e){return y(e)}if(!R)return y(new e("invalid signature"));const $=b.payload;if(void 0!==$.nbf&&!E.ignoreNotBefore){if("number"!=typeof $.nbf)return y(new e("invalid nbf value"));if($.nbf>v+(E.clockTolerance||0))return y(new t("jwt not active",new Date(1e3*$.nbf)))}if(void 0!==$.exp&&!E.ignoreExpiration){if("number"!=typeof $.exp)return y(new e("invalid exp value"));if(v>=$.exp+(E.clockTolerance||0))return y(new r("jwt expired",new Date(1e3*$.exp)))}if(E.audience){const t=Array.isArray(E.audience)?E.audience:[E.audience];if(!(Array.isArray($.aud)?$.aud:[$.aud]).some((function(e){return t.some((function(t){return t instanceof RegExp?t.test(e):t===e}))})))return y(new e("jwt audience invalid. expected: "+t.join(" or ")))}if(E.issuer){if("string"==typeof E.issuer&&$.iss!==E.issuer||Array.isArray(E.issuer)&&-1===E.issuer.indexOf($.iss))return y(new e("jwt issuer invalid. expected: "+E.issuer))}if(E.subject&&$.sub!==E.subject)return y(new e("jwt subject invalid. expected: "+E.subject));if(E.jwtid&&$.jti!==E.jwtid)return y(new e("jwt jwtid invalid. expected: "+E.jwtid));if(E.nonce&&$.nonce!==E.nonce)return y(new e("jwt nonce invalid. expected: "+E.nonce));if(E.maxAge){if("number"!=typeof $.iat)return y(new e("iat required when maxAge is specified"));const t=i(E.maxAge,$.iat);if(void 0===t)return y(new e('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(v>=t+(E.clockTolerance||0))return y(new r("maxAge exceeded",new Date(1e3*t)))}if(!0===E.complete){const e=b.signature;return y(null,{header:S,payload:$,signature:e})}return y(null,$)}))},Ht}function Dr(){if(qt)return Kt;qt=1;var e=1/0,t=9007199254740991,r=17976931348623157e292,n=NaN,i="[object Arguments]",s="[object Function]",o="[object GeneratorFunction]",a="[object String]",u="[object Symbol]",c=/^\s+|\s+$/g,f=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,h=/^0o[0-7]+$/i,p=/^(?:0|[1-9]\d*)$/,d=parseInt;function m(e){return e!=e}function E(e,t){return function(e,t){for(var r=-1,n=e?e.length:0,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}(t,(function(t){return e[t]}))}var g,y,v=Object.prototype,w=v.hasOwnProperty,b=v.toString,S=v.propertyIsEnumerable,R=(g=Object.keys,y=Object,function(e){return g(y(e))}),$=Math.max;function T(e,t){var r=O(e)||function(e){return function(e){return P(e)&&j(e)}(e)&&w.call(e,"callee")&&(!S.call(e,"callee")||b.call(e)==i)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,s=!!n;for(var o in e)!t&&!w.call(e,o)||s&&("length"==o||A(o,n))||r.push(o);return r}function I(e){if(r=(t=e)&&t.constructor,n="function"==typeof r&&r.prototype||v,t!==n)return R(e);var t,r,n,i=[];for(var s in Object(e))w.call(e,s)&&"constructor"!=s&&i.push(s);return i}function A(e,r){return!!(r=null==r?t:r)&&("number"==typeof e||p.test(e))&&e>-1&&e%1==0&&e<r}var O=Array.isArray;function j(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=t}(e.length)&&!function(e){var t=N(e)?b.call(e):"";return t==s||t==o}(e)}function N(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function P(e){return!!e&&"object"==typeof e}return Kt=function(t,i,s,o){var p;t=j(t)?t:(p=t)?E(p,function(e){return j(e)?T(e):I(e)}(p)):[],s=s&&!o?function(t){var i=function(t){if(!t)return 0===t?t:0;if(t=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||P(e)&&b.call(e)==u}(e))return n;if(N(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=N(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(c,"");var r=l.test(e);return r||h.test(e)?d(e.slice(2),r?2:8):f.test(e)?n:+e}(t),t===e||t===-1/0){return(t<0?-1:1)*r}return t==t?t:0}(t),s=i%1;return i==i?s?i-s:i:0}(s):0;var g=t.length;return s<0&&(s=$(g+s,0)),function(e){return"string"==typeof e||!O(e)&&P(e)&&b.call(e)==a}(t)?s<=g&&t.indexOf(i,s)>-1:!!g&&function(e,t,r){if(t!=t)return function(e,t,r,n){for(var i=e.length,s=r+(n?1:-1);n?s--:++s<i;)if(t(e[s],s,e))return s;return-1}(e,m,r);for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}(t,i,s)>-1},Kt}function Mr(){if(Yt)return Jt;Yt=1;var e=1/0,t=17976931348623157e292,r=NaN,n="[object Symbol]",i=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,u=parseInt,c=Object.prototype.toString;function f(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}return Jt=function(l){return"number"==typeof l&&l==function(l){var h=function(l){if(!l)return 0===l?l:0;if(l=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&c.call(e)==n}(e))return r;if(f(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=f(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var l=o.test(e);return l||a.test(e)?u(e.slice(2),l?2:8):s.test(e)?r:+e}(l),l===e||l===-1/0){return(l<0?-1:1)*t}return l==l?l:0}(l),p=h%1;return h==h?p?h-p:h:0}(l)}}function Fr(){if(sr)return ir;sr=1;var e=1/0,t=17976931348623157e292,r=NaN,n="[object Symbol]",i=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,u=parseInt,c=Object.prototype.toString;function f(f,h){var p;if("function"!=typeof h)throw new TypeError("Expected a function");return f=function(f){var h=function(f){if(!f)return 0===f?f:0;if(f=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&c.call(e)==n}(e))return r;if(l(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=l(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var f=o.test(e);return f||a.test(e)?u(e.slice(2),f?2:8):s.test(e)?r:+e}(f),f===e||f===-1/0){return(f<0?-1:1)*t}return f==f?f:0}(f),p=h%1;return h==h?p?h-p:h:0}(f),function(){return--f>0&&(p=h.apply(this,arguments)),f<=1&&(h=void 0),p}}function l(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}return ir=function(e){return f(2,e)}}function Gr(){if(ar)return or;ar=1;const e=ee(),t=Cr(),r=kr(),n=X(),i=Dr(),s=function(){if(Wt)return Xt;Wt=1;var e=Object.prototype.toString;return Xt=function(t){return!0===t||!1===t||function(e){return!!e&&"object"==typeof e}(t)&&"[object Boolean]"==e.call(t)}}(),o=Mr(),a=function(){if(Qt)return Zt;Qt=1;var e=Object.prototype.toString;return Zt=function(t){return"number"==typeof t||function(e){return!!e&&"object"==typeof e}(t)&&"[object Number]"==e.call(t)}}(),u=function(){if(tr)return er;tr=1;var e,t,r=Function.prototype,n=Object.prototype,i=r.toString,s=n.hasOwnProperty,o=i.call(Object),a=n.toString,u=(e=Object.getPrototypeOf,t=Object,function(r){return e(t(r))});return er=function(e){if(!function(e){return!!e&&"object"==typeof e}(e)||"[object Object]"!=a.call(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e))return!1;var t=u(e);if(null===t)return!0;var r=s.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&i.call(r)==o}}(),c=function(){if(nr)return rr;nr=1;var e=Object.prototype.toString,t=Array.isArray;return rr=function(r){return"string"==typeof r||!t(r)&&function(e){return!!e&&"object"==typeof e}(r)&&"[object String]"==e.call(r)}}(),f=Fr(),{KeyObject:l,createSecretKey:h,createPrivateKey:p}=F.default,d=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];t&&d.splice(3,0,"PS256","PS384","PS512");const m={expiresIn:{isValid:function(e){return o(e)||c(e)&&e},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(e){return o(e)||c(e)&&e},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(e){return c(e)||Array.isArray(e)},message:'"audience" must be a string or array'},algorithm:{isValid:i.bind(null,d),message:'"algorithm" must be a valid string enum value'},header:{isValid:u,message:'"header" must be an object'},encoding:{isValid:c,message:'"encoding" must be a string'},issuer:{isValid:c,message:'"issuer" must be a string'},subject:{isValid:c,message:'"subject" must be a string'},jwtid:{isValid:c,message:'"jwtid" must be a string'},noTimestamp:{isValid:s,message:'"noTimestamp" must be a boolean'},keyid:{isValid:c,message:'"keyid" must be a string'},mutatePayload:{isValid:s,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:s,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:s,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},E={iat:{isValid:a,message:'"iat" should be a number of seconds'},exp:{isValid:a,message:'"exp" should be a number of seconds'},nbf:{isValid:a,message:'"nbf" should be a number of seconds'}};function g(e,t,r,n){if(!u(r))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(r).forEach((function(i){const s=e[i];if(s){if(!s.isValid(r[i]))throw new Error(s.message)}else if(!t)throw new Error('"'+i+'" is not allowed in "'+n+'"')}))}const y={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},v=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];return or=function(t,i,s,o){"function"==typeof s?(o=s,s={}):s=s||{};const a="object"==typeof t&&!Buffer.isBuffer(t),u=Object.assign({alg:s.algorithm||"HS256",typ:a?"JWT":void 0,kid:s.keyid},s.header);function c(e){if(o)return o(e);throw e}if(!i&&"none"!==s.algorithm)return c(new Error("secretOrPrivateKey must have a value"));if(null!=i&&!(i instanceof l))try{i=p(i)}catch(e){try{i=h("string"==typeof i?Buffer.from(i):i)}catch(e){return c(new Error("secretOrPrivateKey is not valid key material"))}}if(u.alg.startsWith("HS")&&"secret"!==i.type)return c(new Error(`secretOrPrivateKey must be a symmetric key when using ${u.alg}`));if(/^(?:RS|PS|ES)/.test(u.alg)){if("private"!==i.type)return c(new Error(`secretOrPrivateKey must be an asymmetric key when using ${u.alg}`));if(!s.allowInsecureKeySizes&&!u.alg.startsWith("ES")&&void 0!==i.asymmetricKeyDetails&&i.asymmetricKeyDetails.modulusLength<2048)return c(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${u.alg}`))}if(void 0===t)return c(new Error("payload is required"));if(a){try{!function(e){g(E,!0,e,"payload")}(t)}catch(e){return c(e)}s.mutatePayload||(t=Object.assign({},t))}else{const e=v.filter((function(e){return void 0!==s[e]}));if(e.length>0)return c(new Error("invalid "+e.join(",")+" option for "+typeof t+" payload"))}if(void 0!==t.exp&&void 0!==s.expiresIn)return c(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(void 0!==t.nbf&&void 0!==s.notBefore)return c(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{!function(e){g(m,!1,e,"options")}(s)}catch(e){return c(e)}if(!s.allowInvalidAsymmetricKeyTypes)try{r(u.alg,i)}catch(e){return c(e)}const d=t.iat||Math.floor(Date.now()/1e3);if(s.noTimestamp?delete t.iat:a&&(t.iat=d),void 0!==s.notBefore){try{t.nbf=e(s.notBefore,d)}catch(e){return c(e)}if(void 0===t.nbf)return c(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(void 0!==s.expiresIn&&"object"==typeof t){try{t.exp=e(s.expiresIn,d)}catch(e){return c(e)}if(void 0===t.exp)return c(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(y).forEach((function(e){const r=y[e];if(void 0!==s[e]){if(void 0!==t[r])return c(new Error('Bad "options.'+e+'" option. The payload already has an "'+r+'" property.'));t[r]=s[e]}}));const w=s.encoding||"utf8";if("function"!=typeof o){let e=n.sign({header:u,payload:t,secret:i,encoding:w});if(!s.allowInsecureKeySizes&&/^(?:RS|PS)/.test(u.alg)&&e.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${u.alg}`);return e}o=o&&f(o),n.createSign({header:u,privateKey:i,payload:t,encoding:w}).once("error",o).once("done",(function(e){if(!s.allowInsecureKeySizes&&/^(?:RS|PS)/.test(u.alg)&&e.length<256)return o(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${u.alg}`));o(null,e)}))}}var Br=cr?ur:(cr=1,ur={decode:W(),verify:xr(),sign:Gr(),JsonWebTokenError:J(),NotBeforeError:Y(),TokenExpiredError:Z()});return{state:{hasSetState:!1,env:"dev",pages:void 0,useRefreshToken:!1,storeValue:async()=>{},navigateTo:async()=>{},clearStore:async()=>{},showAlert:async()=>{}},field:{token:"tokens",authorizedPage:"authorizedPages"},errorConst:{unexpectedError:{code:"unexpectedError",message:"Unexpected error"},unauthorizedUser:{code:"EVAC4007",message:"unauthorized user"},forbiddenAction:{code:"EVAC6007",message:"forbidden action"},requiredPageData:{code:"EVAC6008",message:"required page data"},requiredSetStateData:{code:"EVAC6009",message:"state data is required to be set"},tokenExpired:{code:"EVAC4008",message:"token has expired"}},config:{env:{dev:{host:"https://evm-rbac.staging.evermosa2z.com"}},path:{user:{login:"/v1/user/login",refreshToken:"/v1/user/refresh",logout:"/v1/user/logout",register:"/v1/user/register"},subject:{authorize:"/v1/subject/authorize",refreshToken:"/v1/subject/refresh",logout:"/v1/subject/logout",assignSubject:"/v1/subject/role",unassignSubject:"/v1/subject/role",list:"/v1/subject/list"}}},setState(e,t,r,n,i,s=!1){return this.state.hasSetState=!0,this.state.env=e,this.state.storeValue=t,this.state.navigateTo=r,this.state.clearStore=n,this.state.showAlert=i,this.state.useRefreshToken=s,this},setPages(e){return this.state.pages=e,this},setUseRefreshToken(e){return this.state.useRefreshToken=e,this},decodeToken:e=>Br.decode(e),checkPrerequisiteFunction(e={needPageData:!1}){return this.state.hasSetState?null==this.state.pages&&void 0!==e.needPageData&&e.needPageData?this.wrapResult(this.newError(this.errorConst.requiredPageData.code,this.errorConst.requiredPageData.message),!0):this.wrapResult(!0):this.wrapResult(this.newError(this.errorConst.requiredSetStateData.code,this.errorConst.requiredSetStateData.message),!0)},wrapResult:(e,t=!1)=>t?{code:e.errorCode,error:e.error}:{data:e},newError:(e,t)=>({errorCode:e,error:t}),composeHeaderAuthorization:e=>({"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+e}),getFirstAuthorizedPage(){for(const e in appsmith.store.authorizedPages){return appsmith.store.authorizedPages[e]}return this.wrapResult(this.newError(this.errorConst.forbiddenAction.code,this.errorConst.forbiddenAction.message),!0)},async setAuthorizedPage(e){let t={};if(null==e.subjectAccessToken)return await this.state.storeValue(this.field.authorizedPage,t),t;for(const r in e.subjectAccessToken){let n=e.subjectAccessToken[r];if(this.state.pages[n.object]){let e=this.state.pages[n.object],r=this.decodeToken(n.accessToken);e.id==r.objectId&&(t[e.code]=e)}}return await this.state.storeValue(this.field.authorizedPage,t),t},async login(e,t){let r=this.checkPrerequisiteFunction({needPageData:!0});if(r.error)return r;let n=this.config.env[this.state.env].host+this.config.path.user.login;return await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}).then((async e=>{let t=await e.json();return 200===t.statusCode?(await this.state.storeValue(this.field.token,t.data),await this.setAuthorizedPage(t.data),this.wrapResult(t.data)):this.wrapResult(this.newError(t.errorCode,t.error),!0)})).catch((e=>this.wrapResult(this.newError(this.errorConst.unexpectedError,e.message),!0)))},async register(e,t,r,n){let i=this.checkPrerequisiteFunction();if(i.error)return i;let s=this.config.env[this.state.env].host+this.config.path.user.register;return await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t,appName:r,merchantCode:n})}).then((async e=>{let t=await e.json();return 201===t.statusCode?this.wrapResult(t.data):this.wrapResult(this.newError(t.errorCode,t.error),!0)})).catch((e=>this.wrapResult(this.newError(this.errorConst.unexpectedError,e.message),!0)))},async authorizePage(e,t){let r=this.checkPrerequisiteFunction();if(r.error)return r;const n=appsmith.store.tokens.subjectAccessToken.filter((r=>{let n=this.decodeToken(r.accessToken);return r.object===e&&t==n.objectId}));if(0===n.length)return this.wrapResult(this.newError(this.errorConst.forbiddenAction.code,this.errorConst.forbiddenAction.message),!0);let i=n[0].accessToken,s=n[0].refreshToken;try{let e=this.config.env[this.state.env].host+this.config.path.subject.authorize;const t=await fetch(e,{method:"POST",headers:this.composeHeaderAuthorization(i)});let r=await t.json();if(200!=r.statusCode){if(this.state.useRefreshToken&&r.errorCode==this.errorConst.tokenExpired.code){let t=await this.subjectRefreshToken(s);if(t.error)return t.code==this.errorConst.tokenExpired.code&&await this.state.clearStore(this.field.token),this.wrapResult(this.newError(t.code,t.error),!0);const r=await fetch(e,{method:"POST",headers:this.composeHeaderAuthorization(t.data.accessToken)});let n=await r.json();return 200!=n.statusCode?this.wrapResult(this.newError(n.errorCode,n.error),!0):this.wrapResult(!0)}return r.errorCode==this.errorConst.tokenExpired.code&&await this.state.clearStore(this.field.token),this.wrapResult(this.newError(r.errorCode,r.error),!0)}return this.wrapResult(!0)}catch(e){return this.wrapResult(this.newError(this.errorConst.unexpectedError,e.message),!0)}},async logout(){let e=this.checkPrerequisiteFunction();if(e.error)return e;try{let e=this.config.env[this.state.env].host+this.config.path.user.logout;const t=await fetch(e,{method:"POST",headers:this.composeHeaderAuthorization(appsmith.store.tokens.accessToken)});let r=await t.json();return 200!=r.statusCode?this.wrapResult(this.newError(r.errorCode,r.error),!0):(await this.state.clearStore(this.field.token),this.wrapResult("success"))}catch(e){return this.wrapResult(this.newError(this.errorConst.unexpectedError,e.message),!0)}},async refreshToken(){let e=this.checkPrerequisiteFunction();if(e.error)return e;try{let e=this.config.env[this.state.env].host+this.config.path.user.refreshToken;const t=await fetch(e,{method:"POST",headers:this.composeHeaderAuthorization(appsmith.store.tokens.refreshToken)});let r=await t.json();return 200===r.statusCode?(appsmith.store.tokens.accessToken=r.data.accessToken,appsmith.store.tokens.refreshToken=r.data.refreshToken,await this.state.storeValue(this.field.token,tokens),this.wrapResult(r.data)):this.wrapResult(this.newError(r.errorCode,r.error),!0)}catch(e){return this.wrapResult(this.newError(this.errorConst.unexpectedError,e.message),!0)}},async subjectLogout(e){let t=this.checkPrerequisiteFunction();if(t.error)return t;try{let t=this.config.env[this.state.env].host+this.config.path.subject.logout;const r=await fetch(t,{method:"POST",headers:this.composeHeaderAuthorization(e)});let n=await r.json();return 200!=n.statusCode?this.wrapResult(this.newError(n.errorCode,n.error),!0):this.wrapResult(!0)}catch(e){return this.wrapResult(this.newError(this.errorConst.unexpectedError,e.message),!0)}},async subjectRefreshToken(e){let t=this.checkPrerequisiteFunction();if(t.error)return t;try{let t=this.config.env[this.state.env].host+this.config.path.subject.refreshToken,r=-1,n=appsmith.store.tokens;for(let t=0;t<n.subjectAccessToken.length;t++)if(n.subjectAccessToken[t].refreshToken==e){r=t;break}const i=await fetch(t,{method:"POST",headers:this.composeHeaderAuthorization(e)});let s=await i.json();return 200===s.statusCode?(-1!=r?(n.subjectAccessToken[r].accessToken=s.data.accessToken,n.subjectAccessToken[r].refreshToken=s.data.refreshToken):n.subjectAccessToken.push(s.data),await this.state.storeValue(this.field.token,n),this.wrapResult(s.data)):this.wrapResult(this.newError(s.errorCode,s.error),!0)}catch(e){return this.wrapResult(this.newError(this.errorConst.unexpectedError,e.message),!0)}},async subjectList(e={name:void 0,code:void 0,sortBy:void 0,sortDirection:void 0,page:void 0,size:void 0}){let t=this.checkPrerequisiteFunction();if(t.error)return t;try{let t=new URL(this.config.env[this.state.env].host+this.config.path.subject.list);const r=new URLSearchParams({name:e.name,code:e.code,sortBy:e.sortBy,sortDirection:e.sortDirection,page:e.page,size:e.size});t.search=r;const n=await fetch(t.toString(),{method:"GET",headers:this.composeHeaderAuthorization(appsmith.store.tokens.accessToken)});let i=await n.json();return 200!=i.statusCode?this.wrapResult(this.newError(i.errorCode,i.error),!0):this.wrapResult(i.data)}catch(e){return this.wrapResult(this.newError(this.errorConst.unexpectedError,e.message),!0)}},async assignSubject(e=[]){let t=this.checkPrerequisiteFunction();if(t.error)return t;try{let t=new URL(this.config.env[this.state.env].host+this.config.path.subject.assignSubject);const r=await fetch(t.toString(),{method:"POST",headers:this.composeHeaderAuthorization(appsmith.store.tokens.accessToken),body:JSON.stringify(e)});let n=await r.json();return 200!=n.statusCode?this.wrapResult(this.newError(n.errorCode,n.error),!0):this.wrapResult(n.data)}catch(e){return this.wrapResult(this.newError(this.errorConst.unexpectedError,e.message),!0)}},async unassignSubject(e=[]){let t=this.checkPrerequisiteFunction();if(t.error)return t;try{let t=new URL(this.config.env[this.state.env].host+this.config.path.subject.unassignSubject);const r=await fetch(t.toString(),{method:"DELETE",headers:this.composeHeaderAuthorization(appsmith.store.tokens.accessToken),body:JSON.stringify(e)});let n=await r.json();return 200!=n.statusCode?this.wrapResult(this.newError(n.errorCode,n.error),!0):this.wrapResult(n.data)}catch(e){return this.wrapResult(this.newError(this.errorConst.unexpectedError,e.message),!0)}}}}));
